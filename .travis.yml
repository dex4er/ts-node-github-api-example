sudo: false

language: node_js

matrix:
  include:
    - node_js: 'node'
      env: NPM_PACK=yes NPM_AUDIT=yes
    - node_js: '10'
    - node_js: '8'

install:
  - npm install
  - if [ -n "$NPM_AUDIT" ]; then npm audit; fi

script:
  - npm run github-apiv4-get-schema
  - if [ -n "$NPM_PACK" ]; then npm pack; else npm run compile; fi
  - node bin/github-apiv4-viewer-query
  - npm run clean
  - git add .
  - git diff-index --stat --exit-code HEAD
